---
interface Props {
  url: string;
}

const { url } = Astro.props;

function getEmbedCode(url: string) {
  // SoundCloud embed
  if (url.includes('soundcloud.com')) {
    const encodedUrl = encodeURIComponent(url);
    return `<iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=${encodedUrl}&color=%23000000&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true"></iframe>`;
  }
  
  // YouTube embed
  if (url.includes('youtube.com') || url.includes('youtu.be')) {
    let videoId = '';
    
    if (url.includes('youtube.com/watch?v=')) {
      videoId = url.split('v=')[1]?.split('&')[0] || '';
    } else if (url.includes('youtu.be/')) {
      videoId = url.split('youtu.be/')[1]?.split('?')[0] || '';
    }
    
    if (videoId) {
      return `<iframe width="100%" height="315" src="https://www.youtube.com/embed/${videoId}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
    }
  }
  
  return null;
}

const embedCode = getEmbedCode(url);
---

{embedCode && (
  <div class="mb-8">
    <div class="aspect-video" set:html={embedCode} />
  </div>
)}